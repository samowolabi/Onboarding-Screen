<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>	
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/bootstrap.min.css" >
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/fonts.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/fontface.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/style.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialButtonIcon.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialContextMenu.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialDrawer.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialShared.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialCard.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialChip.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialButton.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialSnackBar.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialDialogBox.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialRating.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialInputChoice.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialInputTextArea.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialProgressCircle.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialDeadlineCircle.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialDeadlineCircleMega.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialText.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialLink.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialCardProgress.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialLesson.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialProgressBar.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialBarDashboard.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/animate.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialSwitch.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialOutline.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialPlaceHolder.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialInput.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/materialForm.css">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/margin-helpers-compiled.css">
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="assets/css/style.css">
</head>
<body>
    <!-- Modal Container
    <section class="materialLightBox">
    </section> -->

    <div class="loadingIconContainer">
        <div class="loadingIconDiv">
            <img src="logo-transparent-BG.png" alt="">
        </div>
    </div> 

    <div class="materialFloatingButtonContainer">
        <div class="materialFloatingLinkButton" onclick="backToHomeFunc()">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 18V15" stroke-linecap="round" stroke-linejoin="round"/><path d="M10.07 2.81997L3.14002 8.36997C2.36002 8.98997 1.86002 10.3 2.03002 11.28L3.36002 19.24C3.60002 20.66 4.96002 21.81 6.40002 21.81H17.6C19.03 21.81 20.4 20.65 20.64 19.24L21.97 11.28C22.13 10.3 21.63 8.98997 20.86 8.36997L13.93 2.82997C12.86 1.96997 11.13 1.96997 10.07 2.81997Z" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
        <div class="materialFloatingLinkButton loginLogOutBtn" onclick="loginLogOutUser(this)"></div>
        <div class="materialFloatingButton">
            <svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.625 13H24.375" stroke-linecap="round" stroke-linejoin="round"/><path d="M1.625 22.75H24.375" stroke-linecap="round" stroke-linejoin="round"/><path d="M1.625 3.25H24.375" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <svg width="25" height="24" viewBox="0 0 25 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.50018 1.5L22.8629 22.5627" stroke-linecap="round" stroke-linejoin="round"/><path d="M22.8625 1.5L1.49986 22.5627" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </div>
    </div>

    <section class="homePageSwitchAppsContainer">
        
    </section>

    <script src="assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/jquery-latest.min.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/polyfills.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/ripplet.js@0.1.13.js"></script>

	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/hammer.min.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/materialShared.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/materialHistory.js"></script>

	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/materialComponent.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/materialButton.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/materialSnackBar.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/materialDrawer.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/materialRating.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/materialDialog.js"></script>
	<script type="text/javascript" src="https://learn.pianoencyclopedia.com/hydra/HydraCreator/live-editor/modules-assets/app-generic/js/materialInputChoice.js"></script>
    <script src="assets/js/script.js"></script>
    <script src="assets/js/app.dialogs.user-authentication.js"></script>
    <script>
        var config = {};
        config.appName = "GlobalApp";
    </script>
	
    <script>
        function showHideLoaderTimeout() {
            showHideLoader('close'); // Hide Loader
        }

        // Load App iframe
        let loadAppIframeFunc = (iframeURL) => {
            let parentSelectorContainer = 'homePageSwitchAppsContainer';
            showHideLoader('open'); // Show Loader

            const setShowHideLoaderTimeout = setTimeout(showHideLoaderTimeout, 1000);

            let htmlContent = `
                <iframe src="${iframeURL}" title="The Piano Encyclopedia Global App"></iframe>
            `;
            document.querySelector('.' + parentSelectorContainer).innerHTML = htmlContent;

            document.querySelector('.' + parentSelectorContainer + ' iframe').onload = () => {
                showHideLoader('close');
                clearTimeout(setShowHideLoaderTimeout);
            };
        }

        let openLightBox = (htmlContent) => {
            dialogRewardPointsAdded.init = function(thisComponent) {
                thisComponent.html(htmlContent);
            }
            //Show dialog
            materialDialog.show("dialogRewardPointsAdded", {});
        }

        let openAppDetails = (thisElement) => {
            let appButtonLinkFunc = () => { 
                if(thisElement.getAttribute('data-status') === 'locked') {
                    return `
                        <button class="materialButtonOutline materialThemeDark" onclick="loadAppIframeFunc('${thisElement.getAttribute('data-salesUrl')}')" data-value="close">Read More</button>
                        <button class="materialButtonFill materialThemeDark" onclick="loadAppIframeFunc('${thisElement.getAttribute('data-orderUrl')}')" data-value="close">Order Now</button>
                    `;
                } else {
                    return `
                        <button class="materialButtonFill materialThemeDark" onclick="loadAppIframeFunc('${thisElement.getAttribute('data-url')}')" data-value="close">Start Learning</button>
                    `;
                }
            };

            let htmlContent = `
                <section class="materialLightBox">
                    <div> 
                        <img src="${thisElement.getAttribute('data-image')}" alt="">
                        <div class="content">
                            <h2 class="materialHeader materialThemeDark fontFamilyOptimus">${thisElement.getAttribute('data-title')}</h2>
                            <h3 class="materialHeader materialThemeDark fontFamilyLato">${thisElement.getAttribute('data-subtitle')}</h3>
                            <p class="materialParagraph materialThemeDark">
                                ${thisElement.getAttribute('data-description') !== 'undefined' ? thisElement.getAttribute('data-description') : ''}
                            </p>
                            <div class="buttonGroup">${appButtonLinkFunc()}</div>
                        </div>
                    </div>
                </section>
            `;
            openLightBox(htmlContent);
        }

        //Create dialog dynamically
        $('<div id="dialogRewardPointsAdded" class="materialDialog appDetailedContentModalDialog" data-on-init-callback="dialogRewardPointsAdded.init(thisComponent)"></div>').appendTo('body');
        var dialogRewardPointsAdded = {}; 
    

        // Render App UI
        let renderAppFunc = (appJSONData) => {
            let parentSelectorContainer = 'homePageSwitchAppsContainer';

            // Apps
            let appDivContent = ``;
            appJSONData.home.apps.forEach(function(value) {
                function disabledDiv() {
                    return value.status === 'disabled' ? ['disabled', ''] : ['', 'onclick="openAppDetails(this)"'];
                }
                function visibleDiv() {
                    return value.visible ? '' : 'hide';
                }
                function statusDiv() {
                    return value.status === 'locked' ? 'locked' : '';
                }
                function highlightedDiv() {
                    return value.highlight  ? 'highlighted' : '';
                }

                appDivContent += `
                    <div id="${value.url}" data-button="" class="materialCard ${visibleDiv()} ${statusDiv()} ${highlightedDiv()} ${disabledDiv()[0]}" ${disabledDiv()[1]} data-image="${value.image}" data-title="${value.title}" data-subtitle="${value.subtitle}" data-description="${value.description}" data-url="${value.url}" data-salesUrl="${value.salesUrl}" data-orderUrl="${value.orderUrl}" data-status="${value.status}">
                        <div class="materialCardImg">
                            <div class="materialCardImgInside" style="background-image: url(${value.image}); background-color: grey;"></div> 
                            <div class="materialCardImgOverlay "></div>
                            <div class="materialCardMediaType materialThemeLightGold materialThemeFlat">
                                    <i class="fa fa-graduation-cap" title="Course"></i>
                            </div> 
                            <div class="materialCardNew materialThemeLightGold materialThemeFlat">
                                <span data-progress="0">
                                    <span data-new="" style="display: inline;"><i>APP</i></span>
                                    <span data-incomplete="" style="display: none;"><span data-progress-affects-html="">0</span>%</span>
                                    <span data-complete="" style="display: none;"><i class="fa fa-check"></i></span>
                                </span>
                            </div>
                        </div>
                        <div class="content"><h3 class="materialHeader materialThemeDark fontFamilyLato">${value.title}</h3></div>
                    </div>
                `;
            }); 

            let htmlContent = `
                <div><h2 class="materialHeader fontFamilyOptimus">${appJSONData.home.title}</h2></div>
                <div class="elementSeparatorOrnament"><img src="assets/img/Separator.min.png" alt=""></div>
                <div class="homePageSwitchAppsDiv">${appDivContent}</div>
            `;
            showHidePlaceHolder('close'); // Hide PlaceLoader
            document.querySelector('.' + parentSelectorContainer).innerHTML = htmlContent;
        }


        // Logged In Status
        let loggedInStatus = (response) => {
            document.querySelector('.homePageSwitchAppsContainer h2').innerHTML = `Hi ${response.name}, The Piano Encyclopedia`; // Update Header
            document.querySelector('.materialFloatingButtonContainer .loginLogOutBtn').setAttribute("data-logged", "yes");
            document.querySelector('.materialFloatingButtonContainer .loginLogOutBtn').innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.90002 7.55999C9.21002 3.95999 11.06 2.48999 15.11 2.48999H15.24C19.71 2.48999 21.5 4.27999 21.5 8.74999V15.27C21.5 19.74 19.71 21.53 15.24 21.53H15.11C11.09 21.53 9.24002 20.08 8.91002 16.54" stroke-linecap="round" stroke-linejoin="round"/><path d="M15 12H3.62" stroke-linecap="round" stroke-linejoin="round"/><path d="M5.85 8.6499L2.5 11.9999L5.85 15.3499" stroke-linecap="round" stroke-linejoin="round"/></svg>`;
        }

        // Logged Out Status
        let loggedOutStatus = () => {
            document.querySelector('.homePageSwitchAppsContainer h2').innerHTML = `The Piano Encyclopedia`; // Update Header
            document.querySelector('.materialFloatingButtonContainer .loginLogOutBtn').setAttribute("data-logged", "no")
            document.querySelector('.materialFloatingButtonContainer .loginLogOutBtn').innerHTML = `<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.90002 7.55999C9.21002 3.95999 11.06 2.48999 15.11 2.48999H15.24C19.71 2.48999 21.5 4.27999 21.5 8.74999V15.27C21.5 19.74 19.71 21.53 15.24 21.53H15.11C11.09 21.53 9.24002 20.08 8.91002 16.54" stroke-linecap="round" stroke-linejoin="round"/><path d="M2 12H14.88" stroke-linecap="round" stroke-linejoin="round"/><path d="M12.65 8.6499L16 11.9999L12.65 15.3499" stroke-linecap="round" stroke-linejoin="round"/></svg>`;
        }

        // Login and Log Out Status
        let logUserInOutFunc = (response) => {
            if (response.logged) {
                loggedInStatus(response);
            } else {
                loggedOutStatus();
            }
        }

        let fetchedResponseCallback = (response) => {
            response = JSON.parse(response);

            // Render App UI
            renderAppFunc(response);
			material.init($("body"));

            // Update Login and Log Out Status
            logUserInOutFunc(response);
		}

        let formData = {
            "url": window.location.href,
            "referrer": document.referrer, 
            "hs_uid": (localStorage.getItem('hs_uid') || ""), 
            "hs_uidh": (localStorage.getItem('hs_uidh') || "")
        }

        // Call Ajax Function to fetch Apps Content
        callAjaxFunc(formData, fetchedResponseCallback);


        // Go Home
        let backToHomeFunc = () => {
            // Call Ajax Function to fetch Apps Content
            callAjaxFunc(formData, fetchedResponseCallback);
        }

        // loginLogOutFunc()
        let loginLogOutUser = (thisElement) => {
            if(thisElement.getAttribute('data-logged') === 'yes') {
                materialDialog.show("dialogLogout", {"modal": true});
            }
            if(thisElement.getAttribute('data-logged') === 'no') {
                materialDialog.show("dialogLogin", {modal: true, hideCallback: function(){}});
            }
        }
    </script>
</body>
</html>